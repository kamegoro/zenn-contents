---
title: "Storybookã®CSF2ã‹ã‚‰CSF3ã¸ã®ç§»è¡Œä½œæ¥­"
emoji: "ğŸ“"
type: "tech"
topics: ["Storybook"]
published: true
---

## èƒŒæ™¯

ãšã£ã¨å¾Œå›ã—ã«ã—ã¦æ®‹ã£ã¦ã„ã‚‹éæ¨å¥¨ã«ãªã£ãŸ CSF2 ã®è¨˜æ³•ã‚’ã¼ã¡ã¼ã¡ç§»è¡Œã—ãŸã„

ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆå†…å®¹ã«ã¤ã„ã¦
https://storybook.js.org/blog/storybook-csf3-is-here/

> CSF3 is fully backwards compatible, so your existing CSF stories still work fine without modification. We wonâ€™t deprecate the old format any time soon. However, CSF3 is a big step forward, and we recommend upgrading your stories as part of upgrading to Storybook 7.0 (SB7).

CSF2 ã®è¨˜æ³•ãŒç›´è¿‘ã§å»ƒæ­¢ã•ã‚Œã‚‹äºˆå®šã¯ç„¡ã„ã‘ã‚Œã©ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã—ã¦ã»ã—ã„ã¿ãŸã„ãªæ„Ÿã˜ã€‚

![csf2-code](/images/3946f8ac30499e/csf2-code.png)

## ç§»è¡Œã®æµã‚Œ

åŸºæœ¬çš„ã«ã¯ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚¬ã‚¤ãƒ‰ã«è¼‰ã£ã¦ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å©ã‘ã°ä¸€ç™º
https://storybook.js.org/docs/react/migration-guide

```bash
npx storybook@latest migrate csf-2-to-3 --glob="src/components/**/*.stories.tsx"
```

## ç§»è¡Œã«ä¼´ã£ã¦æ‰‹å‹•ã§æ›´æ–°ã—ãŸéƒ¨åˆ†

### 1. `export default`ã®éƒ¨åˆ†ã‚’å¤‰æ•°ã«æ ¼ç´ã—ã¦ã‹ã‚‰`export`ã™ã‚‹ä»•æ§˜ã«å¤‰æ›´

ä¸è¦ã«å‹ã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã™ã‚‹é‹ç”¨ã«ãªã£ã¦ã„ãŸãŸã‚ç§»è¡Œã«ä¼´ã£ã¦ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°

```diff jsx
- export default {
+ const meta: Meta<typeof TextareaForm> = {
  title: 'Molecules/TextareaForm',
  component: TextareaForm,
  args: {
    maxLength: 400,
    minRows: 3,
    placeholder: 'ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼',
    sx: {
      width: 692,
    },
    value: '',
  },
- } as Meta<typeof TextareaForm>;
+ }
+
+ export default meta;
```

### 2. ä¸è¦ãªãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®èª­ã¿è¾¼ã¿ã®å‰Šé™¤

æ—¢å­˜ã® Stories ãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ã«ã‚ˆã£ã¦ã¯ä¸è¦ãª`StoryFn`é–¢æ•°ãŒèª­ã¿è¾¼ã¾ã‚Œã‚‹ã¿ãŸã„

![unnecessary-module](/images/3946f8ac30499e/unnecessary-module.png)

### 3. å¾®å¦™ãªã‚³ãƒ¼ãƒ‰ã®æ•´ç†

```diff jsx
import { Meta, StoryFn } from '@storybook/react';

import ButtonGroup from '~/components/molecules/ButtonGroup';

export default {
  title: 'Molecules/ButtonGroup',
  component: ButtonGroup,
} as Meta<typeof ButtonGroup>;

- export const Default = {
- args: {}, // ã“ã‚Œè¦ã‚‰ãªã„
- };
+ export const Default = {}; // ã“ã‚Œã‚‚æ­£ç›´å¾®å¦™ã ã‘ã©...
```

### 5 ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³ãƒ†ã‚¹ãƒˆã®`play`ã®å‹ã‚¨ãƒ©ãƒ¼

ã“ã‚Œã¯ä»•æ§˜ãªã®ã‹ã„ã¤ã‹ä¿®æ­£ã•ã‚Œã‚‹ã‚‚ã®ã‹ã¯åˆ†ã‹ã‚‰ãªã„ã‘ã©ã€å‹ã‚¨ãƒ©ãƒ¼ã«ãªã£ã¦ã„ãŸã®ã§æ˜ç¤ºçš„ã«å‹å®£è¨€ã‚’ã€‚

ã“ã‚Œã‚’ãƒ¼
![test-before](/images/3946f8ac30499e/test-before.png)

ã“ã†
![test-after](/images/3946f8ac30499e/test-after.png)

### 6. ã‚¿ã‚¤ãƒˆãƒ«ã®å‰Šé™¤

`title`ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒã‚ªãƒ—ã‚·ãƒ§ãƒŠãƒ«ã«ãªã‚Šã€å®šç¾©ãŒãªã„å ´åˆã¯`.stories.tsx`ãŒå®šç¾©ã•ã‚Œã¦ã„ã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒ Storybook ã«è¡¨ç¤ºã•ã‚Œã‚‹å½¢å¼ã«ãªã‚‹ã¨ã„ã†ã“ã¨ã§ç§»è¡Œã€‚

é »ç¹ã«èµ·ã“ã‚Šå¾—ã‚‹ã“ã¨ã§ã¯ãªã„ã‘ã‚Œã©ã€ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’èª¤ã£ãŸå ´æ‰€ã«ä½œã£ã¦ã—ã¾ã£ãŸæ™‚ã«ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ç§»å‹• + ã‚¿ã‚¤ãƒˆãƒ«ã®å¤‰æ›´ã£ã¦ã®ãŒé¢å€’ã§æ¼ã‚Œã‚‚å¤šã‹ã£ãŸ

```tsx
export default {
  // title: 'forms/RegistrationForm' -- optional
  component: RegistrationForm,
};
```
